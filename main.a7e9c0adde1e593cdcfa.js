!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){var i=n(1);"string"==typeof i&&(i=[[t.i,i,""]]);var s={insert:"head",singleton:!1};n(7)(i,s);i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(2)(!1);var i=n(3),s=i(n(4)),o=i(n(5)),r=i(n(6));e.push([t.i,"@font-face {\n    font-family: 'DSEG7-Classic';\n    src:    url("+s+") format('woff2'),\n            url("+o+") format('woff'),\n            url("+r+") format('truetype');\n    font-weight: normal;\n    font-style: normal;\n    font-display: swap;\n}\n\nbody {\n    margin: 0;\n}",""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var s=(r=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(l," */")),o=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot).concat(t," */")}));return[n].concat(o).concat([s]).join("\n")}var r,a,l;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2],"{").concat(n,"}"):n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},s=0;s<this.length;s++){var o=this[s][0];null!=o&&(i[o]=!0)}for(var r=0;r<t.length;r++){var a=t[r];null!=a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="(".concat(a[2],") and (").concat(n,")")),e.push(a))}},e}},function(t,e,n){"use strict";t.exports=function(t,e){return"string"!=typeof(t=t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)||e?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},function(t,e,n){t.exports=n.p+"fonts/b4d9acb3b8b6d632cd320d37f4298939.woff2"},function(t,e,n){t.exports=n.p+"fonts/d318a555bce8d8f009aaa7fb685c3c13.woff"},function(t,e,n){t.exports=n.p+"fonts/afc4edbb61eeaad9eed5bfcd63ada065.ttf"},function(t,e,n){"use strict";var i,s={},o=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},r=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}();function a(t,e){for(var n=[],i={},s=0;s<t.length;s++){var o=t[s],r=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};i[r]?i[r].parts.push(a):n.push(i[r]={id:r,parts:[a]})}return n}function l(t,e){for(var n=0;n<t.length;n++){var i=t[n],o=s[i.id],r=0;if(o){for(o.refs++;r<o.parts.length;r++)o.parts[r](i.parts[r]);for(;r<i.parts.length;r++)o.parts.push(f(i.parts[r],e))}else{for(var a=[];r<i.parts.length;r++)a.push(f(i.parts[r],e));s[i.id]={id:i.id,refs:1,parts:a}}}}function d(t){var e=document.createElement("style");if(void 0===t.attributes.nonce){var i=n.nc;i&&(t.attributes.nonce=i)}if(Object.keys(t.attributes).forEach((function(n){e.setAttribute(n,t.attributes[n])})),"function"==typeof t.insert)t.insert(e);else{var s=r(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var h,u=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function c(t,e,n,i){var s=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=u(e,s);else{var o=document.createTextNode(s),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(o,r[e]):t.appendChild(o)}}function m(t,e,n){var i=n.css,s=n.media,o=n.sourceMap;if(s&&t.setAttribute("media",s),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var g=null,p=0;function f(t,e){var n,i,s;if(e.singleton){var o=p++;n=g||(g=d(e)),i=c.bind(null,n,o,!1),s=c.bind(null,n,o,!0)}else n=d(e),i=m.bind(null,n,e),s=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else s()}}t.exports=function(t,e){(e=e||{}).attributes="object"==typeof e.attributes?e.attributes:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o());var n=a(t,e);return l(n,e),function(t){for(var i=[],o=0;o<n.length;o++){var r=n[o],d=s[r.id];d&&(d.refs--,i.push(d))}t&&l(a(t,e),e);for(var h=0;h<i.length;h++){var u=i[h];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete s[u.id]}}}}},function(t,e,n){"use strict";n.r(e);const i=document.createElement("template");i.innerHTML='\n<style>\n    :host {\n        box-sizing: border-box;\n        display: flex;\n        flex-direction: column;\n        height: 100vh;\n        border: 1vh lightgrey outset;\n        background-color: grey;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n    \n    header, main {\n        display: flex;\n        justify-content: space-around;\n        align-items: center;\n        border: 1vh lightgrey inset;\n        background-color: lightgrey;\n    }\n\n    main {\n        height: 100%;\n    }\n\n    header {\n        padding: 1vh;\n    }\n</style>\n<header>\n    <minesweeper-remaining-mines id="remaining-mines"></minesweeper-remaining-mines>\n    <minesweeper-configuration id="configuration"></minesweeper-configuration>\n    <minesweeper-timer id="timer"></minesweeper-timer>\n</header>\n<main>\n    <minesweeper-board id="board"></minesweeper-board>\n</main>\n';class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(i.content.cloneNode(!0)),this.boardElement=this.shadowRoot.getElementById("board"),this.remainingMinesElement=this.shadowRoot.getElementById("remaining-mines"),this.configurationElement=this.shadowRoot.getElementById("configuration"),this.timerElement=this.shadowRoot.getElementById("timer"),this.boardElement.addEventListener("won",t=>{this.setStateWon()}),this.boardElement.addEventListener("tile-selected",t=>{this.setStateInProgress()}),this.boardElement.addEventListener("lost",t=>{this.setStateLost()}),this.boardElement.addEventListener("flag",t=>{this.remainingMinesElement.decrease()}),this.boardElement.addEventListener("unflag",t=>{this.remainingMinesElement.increase()}),this.boardElement.addEventListener("mousedown",t=>{"in progress"===this.gameState&&this.configurationElement.displaySurprise()}),this.boardElement.addEventListener("mouseup",t=>{"in progress"===this.gameState&&this.configurationElement.displayHappy()}),this.configurationElement.addEventListener("new-game",t=>{this.configuration=t.detail,setTimeout(()=>this.setStateStarted())})}setStateStarted(){this.boardElement.initializeBoard(this.configuration.width,this.configuration.height,this.configuration.mines),this.gameState="started",this.timerElement.reset(),this.configurationElement.displayHappy(),this.remainingMinesElement.reset(this.configuration.mines)}setStateInProgress(){this.gameState="in progress",this.timerElement.isStarted||this.timerElement.start(),this.configurationElement.displayHappy()}setStateWon(){this.gameState="won",this.timerElement.stop(),this.configurationElement.displayWon();const t=this.timerElement.getTime();this.configuration.highScore>t&&this.configurationElement.updateHighScore(t)}setStateLost(){this.gameState="lost",this.timerElement.stop(),this.configurationElement.displayLost()}}customElements.define("minesweeper-game",s);const o=document.createElement("template");o.innerHTML='\n<style>\n    :host {\n        background-color: grey;\n        border: .25rem lightgrey ridge;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n\n    #board {\n        border-collapse: collapse;\n    }\n</style>\n<table id="board"></table>\n';class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(o.content.cloneNode(!0)),this.board=this.shadowRoot.getElementById("board"),this.board.addEventListener("mouseup",t=>{const e=t.target;"MINESWEEPER-TILE"===e.tagName&&1===t.which&&this.active&&!e.isFlagged&&(this.dispatchEvent(new CustomEvent("tile-selected",{bubbles:!0})),this.revealTiles(e),this.isGameFinished()&&(this.active=!1,this.flagAllMines(),this.dispatchEvent(new CustomEvent("won",{bubbles:!0}))))}),this.board.addEventListener("contextmenu",t=>{const e=t.target;"MINESWEEPER-TILE"===e.tagName&&this.active&&!e.visited&&(e.isFlagged?(e.unflag(),this.dispatchEvent(new CustomEvent("unflag",{bubbles:!0}))):(e.flag(),this.dispatchEvent(new CustomEvent("flag",{bubbles:!0})))),t.preventDefault()})}static get observedAttributes(){return["width","height","mines"]}get mines(){return+this.getAttribute("mines")}set mines(t){this.setAttribute("mines",String(t))}get width(){return+this.getAttribute("width")}set width(t){this.setAttribute("width",String(t))}get height(){return+this.getAttribute("height")}set height(t){this.setAttribute("height",String(t))}connectedCallback(){this.width=+this.getAttribute("width"),this.height=+this.getAttribute("height"),this.mines=+this.getAttribute("mines"),setTimeout(()=>this.initializeBoard(this.width,this.height,this.mines))}attributeChangedCallback(t,e,n){}initializeBoard(t=this.width,e=this.height,n=this.mines){if(this.width=t,this.height=e,this.mines=n,this.active=!0,this.mines>this.width*this.height)return void console.error(`${this.mines} mines is greater than the number of places in a ${this.width} x ${this.height} board`);for(;this.board.firstChild;)this.board.removeChild(this.board.firstChild);this.tiles=[];for(let t=0;t<this.height;t++){const e=document.createElement("tr");for(let n=0;n<this.width;n++){let i=document.createElement("minesweeper-tile");i.setAttribute("x",String(t)),i.setAttribute("y",String(n)),this.tiles[t*this.width+n]=i;const s=document.createElement("td");s.appendChild(i),e.appendChild(s)}this.board.appendChild(e)}let i=0;for(;i<this.mines;){const t=Math.floor(Math.random()*(this.width*this.height));this.tiles[t].isMine||(this.tiles[t].isMine=!0,i++)}}revealTiles(t){let e=[];for(e.push(t);e.length;){let t=e.pop();if(t.visited||t.isFlagged)continue;if(t.isMine)return t.revealMine(!0),this.active=!1,this.revealAllMines(),void this.dispatchEvent(new CustomEvent("lost",{bubbles:!0}));let n=0;this.checkSurroundingTiles(t.x,t.y,(t,e)=>{this.tiles[t*this.width+e].isMine&&n++}),t.revealTileCount(n),0===n&&this.checkSurroundingTiles(t.x,t.y,(t,n)=>{const i=this.tiles[t*this.width+n];i.visited||e.push(i)})}}isGameFinished(){return this.tiles.every(t=>t.isMine||!t.isMine&&t.visited)}revealAllMines(){this.tiles.forEach(t=>{t.isMine&&!t.isFlagged&&t.revealMine(),!t.isMine&&t.isFlagged&&t.revealNotMine(),t.disable()})}flagAllMines(){this.tiles.forEach(t=>{t.isMine&&!t.isFlagged&&(t.flag(),this.dispatchEvent(new CustomEvent("flag",{bubbles:!0})))})}checkSurroundingTiles(t,e,n){t-1>=0&&n(t-1,e),t-1>=0&&e-1>=0&&n(t-1,e-1),t-1>=0&&e+1<this.width&&n(t-1,e+1),e-1>=0&&n(t,e-1),e+1<this.width&&n(t,e+1),t+1<this.height&&n(t+1,e),t+1<this.height&&e-1>=0&&n(t+1,e-1),t+1<this.height&&e+1<this.width&&n(t+1,e+1)}}customElements.define("minesweeper-board",r);const a=document.createElement("template");a.innerHTML="\n<style>\n    :host {\n        box-sizing: border-box;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        height: 1.5rem;\n        width: 1.5rem;\n        font-family: arial;\n        font-weight: 900;\n        border: .25rem outset lightgrey;\n        background-color: lightgrey;\n        cursor: pointer;\n        user-select: none;\n        -moz-user-select: none;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n\n    :host([pressed]) {\n        border: none;\n    }\n\n    :host([mine]) {\n        background-color: red;\n    }\n\n    :host([visited]) {\n        border: none;\n    }\n\n    :host([value='1']) {\n        color: var(--minesweeper-tile-one-color, blue);\n    }\n\n    :host([value='2']) {\n        color: var(--minesweeper-tile-two-color, green);\n    }\n\n    :host([value='3']) {\n        color: var(--minesweeper-tile-three-color, red);\n    }\n\n    :host([value='4']) {\n        color: var(--minesweeper-tile-four-color, purple);\n    }\n\n    :host([value='5']) {\n        color: var(--minesweeper-tile-five-color, maroon);\n    }\n\n    :host([value='6']) {\n        color: var(--minesweeper-tile-six-color, turquoise);\n    }\n\n    :host([value='7']) {\n        color: var(--minesweeper-tile-seven-color, black);\n    }\n\n    :host([value='8']) {\n        color: var(--minesweeper-tile-eight-color, grey);\n    }\n</style>\n<div id=\"display\"></div>\n";class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(a.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display"),this.addEventListener("mousedown",t=>{1!==t.buttons||this.isDisabled||this.isFlagged||this.setAttribute("pressed","")}),this.addEventListener("mouseover",t=>{1!==t.buttons||this.isDisabled||this.isFlagged||this.setAttribute("pressed","")}),this.addEventListener("mouseout",t=>{this.removeAttribute("pressed")})}get x(){return+this.getAttribute("x")}set x(t){this.setAttribute("x",String(t))}get y(){return+this.getAttribute("y")}set y(t){this.setAttribute("y",String(t))}get value(){return this.getAttribute("value")}set value(t){this.setAttribute("value",t),this.displayElement.textContent="0"!==this.value?this.value:""}get visited(){return this.hasAttribute("visited")}get isFlagged(){return"🚩"===this.value}connectedCallback(){this.x=+this.getAttribute("x"),this.y=+this.getAttribute("y")}unflag(){this.value=""}flag(){this.value="🚩"}revealNotMine(){this.value="❌",this.setAttribute("visited","")}revealMine(t=!1){t&&this.setAttribute("mine",""),this.value="💣",this.setAttribute("visited","")}revealTileCount(t){this.value=String(t),this.setAttribute("visited","")}disable(){this.isDisabled=!0}}customElements.define("minesweeper-tile",l);const d=document.createElement("template");d.innerHTML="\n<style>\n    :host {\n        background-color: black;\n        color: red;\n        font-family: 'DSEG7-Classic';\n        font-size: 2rem;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n</style>\n<div id=\"display\"></div>\n";class h extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(d.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display"),this.timerCount=0}get isStarted(){return!!this.timerCount}disconnectedCallback(){this.stop()}reset(){this.stop(),this.timerCount=0,this.displayElement.textContent=this.getCount()}start(){this.timerInterval||(this.timerInterval=setInterval(()=>{this.timerCount++,this.displayElement.textContent=this.getCount()},1e3))}stop(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=0)}getTime(){return this.timerCount}getCount(){return String(this.timerCount).padStart(3,"0")}}customElements.define("minesweeper-timer",h);const u=document.createElement("template");u.innerHTML="\n<style>\n    :host {\n        background-color: black;\n        color: red;\n        font-family: 'DSEG7-Classic';\n        font-size: 2rem;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n</style>\n<div id=\"display\"></div>\n";class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(u.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display")}get count(){return+this.getAttribute("count")}set count(t){this.setAttribute("count",String(t))}static get observedAttributes(){return["count"]}attributeChangedCallback(t,e,n){switch(t){case"count":this.displayElement.textContent=this.getCount()}}reset(t){this.count=t}increase(){this.count++}decrease(){this.count--}getCount(){return this.count>=0?String(this.count).padStart(3,"0"):String(this.count).padStart(3," ")}}customElements.define("minesweeper-remaining-mines",c);class m{static getConfigurations(){const t=this.getConfigurationsFromLocalStorage();return t||this.writeConfigurationsToLocalStorage(this.defaultConfigurations),t||this.defaultConfigurations}static getCurrentConfiguration(){return this.defaultConfigurations[0]}static addOrUpdateConfiguration(t){const e=this.getConfigurationsFromLocalStorage()||[],n=e.findIndex(e=>e.id===t.id);-1!==n?e.splice(n,1,t):e.push(t),this.writeConfigurationsToLocalStorage(e)}static getConfigurationsFromLocalStorage(){const t=localStorage.getItem(this.LOCAL_STORAGE_KEY);try{return JSON.parse(t).map(t=>(t.highScore=null===t.highScore?1/0:t.highScore,t))}catch(t){return null}}static writeConfigurationsToLocalStorage(t){localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(t))}}m.defaultConfigurations=[{id:1,name:"Beginner",width:9,height:9,mines:10,highScore:1/0},{id:2,name:"Intermediate",width:16,height:16,mines:40,highScore:1/0},{id:3,name:"Expert",width:30,height:16,mines:99,highScore:1/0}],m.LOCAL_STORAGE_KEY="minesweeper_configuration";const g=document.createElement("template");g.innerHTML='\n<style>\n    :host {\n        font-size: 1.5rem;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n\n    #display:active {\n        border-style: inset;\n    }\n\n    #display {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 1.25rem;\n        height: 2.5rem;\n        width: 2.5rem;\n        border: .25rem lightgrey outset;\n        cursor: pointer;\n    }\n\n    .setup-dropdown {\n        display: none;\n        position: absolute;\n        background-color: lightgrey;\n        border: 1px solid grey;\n        box-shadow: 0 0.5rem 1rem 0 rgba(0, 0, 0, 0.5);\n        cursor: pointer;\n        margin: unset;\n    }\n\n    .setup-dropdown.visible {\n        display: block;\n    }\n\n    .setup-dropdown *:hover {\n        background-color: darkgrey;\n    }\n\n    .setup-dropdown *:active {\n        background-color: grey;\n    }\n\n    .setup-dropdown * {\n        padding: 0.5rem;\n    }\n\n    span {\n        font-size: 50%;\n    }\n</style>\n<button id="display"></button>\n<dl id="setup-dropdown" class="setup-dropdown">\n</dl>\n';class p extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(g.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display"),this.setupDropdownElement=this.shadowRoot.getElementById("setup-dropdown"),this.buildSetupList(),this.shadowRoot.addEventListener("contextmenu",t=>{this.setupDropdownElement.classList.contains("visible")?this.setupDropdownElement.classList.remove("visible"):this.setupDropdownElement.classList.add("visible"),t.preventDefault()}),this.shadowRoot.addEventListener("click",t=>{this.setupDropdownElement.classList.remove("visible");const e=t.target;"DT"===e.tagName&&(this.currentConfiguration=m.getConfigurations().find(t=>String(t.id)===e.id)),"DT"!==e.tagName&&"BUTTON"!==e.tagName||this.dispatchEvent(new CustomEvent("new-game",{detail:this.currentConfiguration,bubbles:!0}))}),this.currentConfiguration=m.getCurrentConfiguration(),this.displayHappy()}connectedCallback(){this.dispatchEvent(new CustomEvent("new-game",{detail:this.currentConfiguration,bubbles:!0}))}displayHappy(){this.displayElement.textContent="😊"}displayLost(){this.displayElement.textContent="☹️"}displaySurprise(){this.displayElement.textContent="😮"}displayWon(){this.displayElement.textContent="😎"}updateHighScore(t){this.currentConfiguration.highScore=t,m.addOrUpdateConfiguration(this.currentConfiguration),this.buildSetupList()}buildSetupList(){for(;this.setupDropdownElement.firstChild;)this.setupDropdownElement.removeChild(this.setupDropdownElement.firstChild);for(let t of m.getConfigurations()){const e=document.createElement("dt"),n=document.createElement("span");e.id=String(t.id),e.textContent=t.name,n.textContent=`${t.width} x ${t.height} board with ${t.mines} mines${t.highScore===1/0?"":` (High score: ${t.highScore})`}`,e.appendChild(n),this.setupDropdownElement.appendChild(e)}}}customElements.define("minesweeper-configuration",p);n(0);!function(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("service-worker.js").then(t=>{console.log("Service Worker registration successful with scope: ",t)},t=>{console.log("Service Worker registration failed: ",t)})});const t=document.createElement("minesweeper-game");document.body.appendChild(t)}()}]);