(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{zUnb:function(e,t,n){"use strict";n.r(t);const i=document.createElement("template");i.innerHTML='\n<style>\n    :host {\n        box-sizing: border-box;\n        display: flex;\n        flex-direction: column;\n        height: 100vh;\n        border: 1vh lightgrey outset;\n        background-color: grey;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n    \n    header, main {\n        display: flex;\n        justify-content: space-around;\n        align-items: center;\n        border: 1vh lightgrey inset;\n        background-color: lightgrey;\n    }\n\n    main {\n        height: 100%;\n    }\n\n    main > * {\n        overflow: auto;\n        max-height: 100%;\n        max-width: 100%;\n    }\n\n    header {\n        padding: 1vh;\n    }\n</style>\n<header>\n    <minesweeper-remaining-mines id="remaining-mines"></minesweeper-remaining-mines>\n    <minesweeper-configuration id="configuration"></minesweeper-configuration>\n    <minesweeper-timer id="timer"></minesweeper-timer>\n</header>\n<main>\n    <minesweeper-board id="board"></minesweeper-board>\n</main>\n';class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(i.content.cloneNode(!0)),this.boardElement=this.shadowRoot.getElementById("board"),this.remainingMinesElement=this.shadowRoot.getElementById("remaining-mines"),this.configurationElement=this.shadowRoot.getElementById("configuration"),this.timerElement=this.shadowRoot.getElementById("timer"),this.handleUpdatingMineCount(),this.handleChangingState(),this.handleChangingExpressionWhenPressingTile()}handleChangingExpressionWhenPressingTile(){this.boardElement.addEventListener("mousedown",e=>{"started"!==this.gameState&&"in progress"!==this.gameState||this.configurationElement.displaySurprise()}),this.boardElement.addEventListener("mouseup",e=>{"started"!==this.gameState&&"in progress"!==this.gameState||this.configurationElement.displayHappy()})}handleChangingState(){this.boardElement.addEventListener("lost",e=>{this.setStateLost()}),this.configurationElement.addEventListener("new-game",e=>{this.configuration=e.detail,setTimeout(()=>this.setStateStarted())}),this.boardElement.addEventListener("tile-select",e=>{this.setStateInProgress()}),this.boardElement.addEventListener("won",e=>{this.setStateWon()})}handleUpdatingMineCount(){this.boardElement.addEventListener("tile-flag",e=>{this.remainingMinesElement.decrease()}),this.boardElement.addEventListener("tile-unflag",e=>{this.remainingMinesElement.increase()})}setStateStarted(){this.boardElement.initializeBoard(this.configuration.width,this.configuration.height,this.configuration.mines),this.gameState="started",this.timerElement.reset(),this.configurationElement.displayHappy(),this.remainingMinesElement.reset(this.configuration.mines)}setStateInProgress(){"started"===this.gameState&&(this.gameState="in progress",this.timerElement.isStarted()||this.timerElement.start(),this.configurationElement.displayHappy())}setStateWon(){this.gameState="won",this.timerElement.stop(),this.configurationElement.displayWon();const e=this.timerElement.getTime();this.configuration.highScore>e&&this.configurationElement.updateHighScore(e)}setStateLost(){this.gameState="lost",this.timerElement.stop(),this.configurationElement.displayLost()}}customElements.get("minesweeper-game")||customElements.define("minesweeper-game",s);const o=document.createElement("template");o.innerHTML="\n<style>\n    :host {\n        font-family: arial;\n        font-weight: 900;\n        cursor: pointer;\n        user-select: none;\n        -moz-user-select: none;\n        outline: none;\n        -moz-outline: none;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n\n    :host(:focus) > #display,\n    #display[pressed] {\n        border: none;\n    }\n    \n    #display {\n        box-sizing: border-box;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        height: 1.5rem;\n        width: 1.5rem;\n        background-color: lightgrey;\n        border: .25rem outset lightgrey;\n    }\n\n    #display[exploded] {\n        background-color: red;\n    }\n\n    #display[visited] {\n        border: none;\n    }\n\n    #display[value='1'] {\n        color: var(--minesweeper-tile-one-color, blue);\n    }\n\n    #display[value='2'] {\n        color: var(--minesweeper-tile-two-color, green);\n    }\n\n    #display[value='3'] {\n        color: var(--minesweeper-tile-three-color, red);\n    }\n\n    #display[value='4'] {\n        color: var(--minesweeper-tile-four-color, purple);\n    }\n\n    #display[value='5'] {\n        color: var(--minesweeper-tile-five-color, maroon);\n    }\n\n    #display[value='6'] {\n        color: var(--minesweeper-tile-six-color, turquoise);\n    }\n\n    #display[value='7'] {\n        color: var(--minesweeper-tile-seven-color, black);\n    }\n\n    #display[value='8'] {\n        color: var(--minesweeper-tile-eight-color, grey);\n    }\n</style>\n<div id=\"display\"></div>\n";class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(o.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display"),this.handleFlaggingTile(),this.handleSelectingTile(),this.handlingPressingTile()}get x(){return+this.getAttribute("x")}set x(e){this.setAttribute("x",String(e))}get y(){return+this.getAttribute("y")}set y(e){this.setAttribute("y",String(e))}get value(){return this.displayElement.getAttribute("value")}set value(e){this.displayElement.setAttribute("value",e),this.displayElement.textContent="0"!==this.value?this.value:""}get visited(){return this.displayElement.hasAttribute("visited")}connectedCallback(){this.hasAttribute("tabindex")||this.setAttribute("tabindex","0")}disable(){this.disabled=!0,this.removeAttribute("tabindex"),this.blur()}flag(){if(this.disabled||this.isFlagged())return;const e=new CustomEvent("tile-flag",{bubbles:!0,cancelable:!0,composed:!0});this.dispatchEvent(e)&&(this.value="🚩")}isDisabled(){return this.disabled}isFlagged(){return"🚩"===this.value}isMine(){return this.mine}revealMine(e=!1){e&&this.displayElement.setAttribute("exploded",""),this.value="💣",this.disable(),this.displayElement.setAttribute("visited","")}revealNotMine(){this.value="❌",this.disable(),this.displayElement.setAttribute("visited","")}revealTileCount(e){this.value=String(e),this.disable(),this.displayElement.setAttribute("visited","")}setMine(){this.mine=!0}unflag(){if(this.disabled||!this.isFlagged())return;const e=new CustomEvent("tile-unflag",{bubbles:!0,cancelable:!0,composed:!0});this.dispatchEvent(e)&&(this.value="")}handleFlaggingTile(){this.addEventListener("contextmenu",e=>{e.preventDefault(),this.toggleFlag()}),this.addEventListener("keydown",e=>{switch(e.key){case"f":this.toggleFlag()}})}handlingPressingTile(){this.addEventListener("mousedown",e=>{e.preventDefault(),1!==e.buttons||this.disabled||this.isFlagged()||this.displayElement.setAttribute("pressed","")}),this.addEventListener("mouseout",e=>{this.displayElement.removeAttribute("pressed")}),this.addEventListener("mouseover",e=>{1!==e.buttons||this.disabled||this.isFlagged()||this.displayElement.setAttribute("pressed","")})}handleSelectingTile(){this.addEventListener("keydown",e=>{switch(e.key){case" ":case"Enter":this.selectTile()}}),this.addEventListener("mouseup",e=>{1===e.which&&this.selectTile()})}toggleFlag(){this.disabled||(this.isFlagged()?this.unflag():this.flag())}selectTile(){this.disabled||this.isFlagged()||this.dispatchEvent(new CustomEvent("tile-select",{bubbles:!0,composed:!0}))}}customElements.get("minesweeper-tile")||customElements.define("minesweeper-tile",r);const a=document.createElement("template");a.innerHTML='\n<style>\n    :host {\n        background-color: grey;\n        border: .25rem lightgrey ridge;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n\n    #board {\n        border-collapse: collapse;\n    }\n</style>\n<table id="board"></table>\n';class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(a.content.cloneNode(!0)),this.board=this.shadowRoot.getElementById("board"),this.handleTileSelection(),this.handleBoardNavigationWithArrowKeys(),this.handlePreventingContextMenu()}get mines(){return+this.getAttribute("mines")}set mines(e){this.setAttribute("mines",String(e))}get width(){return+this.getAttribute("width")}set width(e){this.setAttribute("width",String(e))}get height(){return+this.getAttribute("height")}set height(e){this.setAttribute("height",String(e))}initializeBoard(e=this.width,t=this.height,n=this.mines){if(n>e*t)return void console.error(`${n} mines is greater than the number of places in a ${e} x ${t} board`);for(this.width=e,this.height=t,this.mines=n;this.board.firstChild;)this.board.removeChild(this.board.firstChild);this.tiles=[];for(let e=0;e<this.height;e++){const t=document.createElement("tr");for(let n=0;n<this.width;n++){const i=document.createElement("minesweeper-tile");i.setAttribute("x",String(e)),i.setAttribute("y",String(n)),this.tiles[e*this.width+n]=i;const s=document.createElement("td");s.appendChild(i),t.appendChild(s)}this.board.appendChild(t)}let i=0;for(;i<this.mines;){const e=Math.floor(Math.random()*(this.width*this.height));this.tiles[e].isMine()||(this.tiles[e].setMine(),i++)}}checkSurroundingTiles(e,t,n){e-1>=0&&n(e-1,t),e-1>=0&&t-1>=0&&n(e-1,t-1),e-1>=0&&t+1<this.width&&n(e-1,t+1),t-1>=0&&n(e,t-1),t+1<this.width&&n(e,t+1),e+1<this.height&&n(e+1,t),e+1<this.height&&t-1>=0&&n(e+1,t-1),e+1<this.height&&t+1<this.width&&n(e+1,t+1)}isGameFinished(){return this.tiles.every(e=>e.isMine()||e.visited)}flagAllMines(){this.tiles.forEach(e=>{e.isMine()&&!e.isFlagged()&&e.flag(),e.disable()})}handleBoardNavigationWithArrowKeys(){this.shadowRoot.addEventListener("keydown",e=>{const t=this.shadowRoot.activeElement;if(t&&t.constructor===r){const n=this.tiles.findIndex(e=>e===t);let i=Math.floor(n/this.width),s=n%this.width;switch(e.key){case"ArrowUp":i=(this.height+i-1)%this.height;break;case"ArrowRight":s=(s+1)%this.width;break;case"ArrowDown":i=(i+1)%this.height;break;case"ArrowLeft":s=(this.width+s-1)%this.width}this.tiles[i*this.width+s].focus()}})}handlePreventingContextMenu(){this.shadowRoot.addEventListener("contextmenu",e=>{e.preventDefault()})}handleTileSelection(){this.shadowRoot.addEventListener("tile-select",e=>{const t=e.target;this.revealTiles(t)?(this.revealAllMines(),this.dispatchEvent(new CustomEvent("lost",{bubbles:!0}))):this.isGameFinished()&&(this.flagAllMines(),this.dispatchEvent(new CustomEvent("won",{bubbles:!0})))})}revealAllMines(){this.tiles.forEach(e=>{e.isMine()&&!e.isFlagged()&&e.revealMine(),!e.isMine()&&e.isFlagged()&&e.revealNotMine(),e.disable()})}revealTiles(e){const t=[];for(t.push(e);t.length;){const e=t.pop();if(e.visited||e.isFlagged())continue;if(e.isMine())return e.revealMine(!0),!0;let n=0;this.checkSurroundingTiles(e.x,e.y,(e,t)=>{this.tiles[e*this.width+t].isMine()&&n++}),e.revealTileCount(n),0===n&&this.checkSurroundingTiles(e.x,e.y,(e,n)=>{const i=this.tiles[e*this.width+n];i.visited||t.push(i)})}return!1}}customElements.get("minesweeper-board")||customElements.define("minesweeper-board",l);const d=document.createElement("template");d.innerHTML="\n<style>\n    :host {\n        background-color: black;\n        color: red;\n        font-family: 'DSEG7-Classic';\n        font-size: 2rem;\n        user-select: none;\n        -moz-user-select: none;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n</style>\n<div id=\"display\"></div>\n";const h=3,u=1e3;class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(d.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display"),this.timerCount=0}disconnectedCallback(){this.stop()}isStarted(){return!!this.timerInterval}reset(){this.stop(),this.timerCount=0,this.displayElement.textContent=this.getCount()}start(){this.isStarted()||(this.timerInterval=setInterval(()=>{this.timerCount++,this.displayElement.textContent=this.getCount()},u))}stop(){this.isStarted()&&(clearInterval(this.timerInterval),this.timerInterval=0)}getTime(){return this.timerCount}getCount(){return String(this.timerCount).padStart(h,"0")}}customElements.get("minesweeper-timer")||customElements.define("minesweeper-timer",c);const m=document.createElement("template");m.innerHTML="\n<style>\n    :host {\n        background-color: black;\n        color: red;\n        font-family: 'DSEG7-Classic';\n        font-size: 2rem;\n        user-select: none;\n        -moz-user-select: none;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n\n    #display {\n        white-space: pre;\n    }\n</style>\n<div id=\"display\"></div>\n";const g=3;class p extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(m.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display")}get count(){return+this.getAttribute("count")}set count(e){this.setAttribute("count",String(e))}static get observedAttributes(){return["count"]}attributeChangedCallback(e,t,n){switch(e){case"count":this.displayElement.textContent=this.getCount()}}reset(e){this.count=e}increase(){this.count++}decrease(){this.count--}getCount(){return this.count>=0?String(this.count).padStart(g,"0"):String(this.count).padStart(g," ")}}customElements.get("minesweeper-remaining-mines")||customElements.define("minesweeper-remaining-mines",p);class w{static getConfigurations(){const e=this.getConfigurationsFromLocalStorage();return e||this.writeConfigurationsToLocalStorage(this.defaultConfigurations),null!=e?e:this.defaultConfigurations}static getCurrentConfiguration(){return this.defaultConfigurations[0]}static addOrUpdateConfiguration(e){var t;const n=null!=(t=this.getConfigurationsFromLocalStorage())?t:[],i=n.findIndex(t=>t.id===e.id);-1!==i?n.splice(i,1,e):n.push(e),this.writeConfigurationsToLocalStorage(n)}static getConfigurationsFromLocalStorage(){const e=localStorage.getItem(this.LOCAL_STORAGE_KEY);try{return JSON.parse(e).map(e=>(e.highScore=null===e.highScore?1/0:e.highScore,e))}catch(e){return null}}static writeConfigurationsToLocalStorage(e){localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(e))}}w.defaultConfigurations=[{id:1,name:"Beginner",width:9,height:9,mines:10,highScore:1/0},{id:2,name:"Intermediate",width:16,height:16,mines:40,highScore:1/0},{id:3,name:"Expert",width:30,height:16,mines:99,highScore:1/0}],w.LOCAL_STORAGE_KEY="minesweeper_configuration";const E=document.createElement("template");E.innerHTML='\n<style>\n    :host {\n        font-size: 1.5rem;\n        user-select: none;\n        -moz-user-select: none;\n        outline: none;\n    }\n\n    :host[hidden] {\n        display: none;\n    }\n\n    *:focus {\n        outline: none;\n    }\n    \n    #display {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 1.25rem;\n        height: 2.5rem;\n        width: 2.5rem;\n        border: .25rem lightgrey outset;\n        cursor: pointer;\n    }\n\n    #display:active, #display:focus, #display.firefox-active {\n        border-style: inset;\n    }\n\n    #display::-moz-focus-inner {\n        border: 0;\n    }\n\n    .setup-dropdown {\n        display: none;\n        position: absolute;\n        background-color: lightgrey;\n        border: 1px solid grey;\n        box-shadow: 0 0.5rem 1rem 0 rgba(0, 0, 0, 0.5);\n        cursor: pointer;\n        margin: unset;\n    }\n\n    .setup-dropdown.visible {\n        display: block;\n        padding: 0;\n    }\n\n    .setup-dropdown *:hover, .setup-dropdown *:focus {\n        background-color: darkgrey;\n    }\n\n    .setup-dropdown *:active {\n        background-color: grey;\n    }\n\n    .setup-dropdown * {\n        padding: 0.5rem;\n    }\n\n    span {\n        font-size: 0.5em;\n    }\n\n    li {\n        list-style: none;\n    }\n</style>\n<button id="display"></button>\n<ul id="setup-dropdown" class="setup-dropdown">\n</ul>\n';class b extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(E.content.cloneNode(!0)),this.displayElement=this.shadowRoot.getElementById("display"),this.setupDropdownElement=this.shadowRoot.getElementById("setup-dropdown"),this.buildSetupList(),this.handleNewGameCreation(),this.handleTogglingConfigurationMenu(),this.handleClosingConfigurationMenu(),this.handlePreventingFocusOnMouseEvents(),this.handleFirefoxActiveFlagIssue(),this.currentConfiguration=w.getCurrentConfiguration(),this.displayHappy()}connectedCallback(){this.dispatchEvent(new CustomEvent("new-game",{detail:this.currentConfiguration,bubbles:!0}))}displayHappy(){this.displayElement.textContent="😊"}displayLost(){this.displayElement.textContent="☹️"}displaySurprise(){this.displayElement.textContent="😮"}displayWon(){this.displayElement.textContent="😎"}updateHighScore(e){this.currentConfiguration.highScore=e,w.addOrUpdateConfiguration(this.currentConfiguration),this.buildSetupList()}buildSetupList(){for(;this.setupDropdownElement.firstChild;)this.setupDropdownElement.removeChild(this.setupDropdownElement.firstChild);for(const e of w.getConfigurations()){const t=document.createElement("li"),n=document.createElement("span");t.id=String(e.id),t.textContent=e.name,t.tabIndex=0,n.textContent=`${e.width} x ${e.height} board with ${e.mines} mines${e.highScore===1/0?"":` (High score: ${e.highScore})`}`,t.appendChild(n),this.setupDropdownElement.appendChild(t)}}dispatchNewGame(e){e&&(this.currentConfiguration=w.getConfigurations().find(t=>t.id===e)),this.setupDropdownElement.classList.remove("visible"),this.dispatchEvent(new CustomEvent("new-game",{detail:this.currentConfiguration,bubbles:!0}))}handleClosingConfigurationMenu(){this.shadowRoot.addEventListener("keydown",e=>{"Escape"!==e.key||this.setupDropdownElement.classList.remove("visible")})}handleFirefoxActiveFlagIssue(){this.shadowRoot.addEventListener("mousedown",e=>{this.displayElement.classList.add("firefox-active")}),this.shadowRoot.addEventListener("mouseup",e=>{this.displayElement.classList.remove("firefox-active")}),this.shadowRoot.addEventListener("mouseout",e=>{this.displayElement.classList.remove("firefox-active")})}handleNewGameCreation(){this.shadowRoot.addEventListener("click",e=>{if("display"===e.target.id)return void this.dispatchNewGame();const t=e.target.closest("li");t&&this.dispatchNewGame(+t.id)}),this.shadowRoot.addEventListener("keydown",e=>{const t=e.target.closest("li");if(t)switch(e.key){case" ":case"Enter":this.dispatchNewGame(+t.id)}})}handlePreventingFocusOnMouseEvents(){this.shadowRoot.addEventListener("mousedown",e=>{e.preventDefault()})}handleTogglingConfigurationMenu(){this.shadowRoot.addEventListener("contextmenu",e=>{e.preventDefault(),this.toggleVisible()}),this.shadowRoot.addEventListener("keydown",e=>{/^[a-z0-9]$/.test(e.key)&&this.toggleVisible()})}toggleVisible(){this.setupDropdownElement.classList.contains("visible")?this.setupDropdownElement.classList.remove("visible"):this.setupDropdownElement.classList.add("visible")}}customElements.get("minesweeper-configuration")||customElements.define("minesweeper-configuration",b),function(){const e=document.createElement("minesweeper-game");document.getElementById("minesweeper").appendChild(e)}()}},[["zUnb",0]]]);